name: "ps-bootstrap"
description: "Standard bootstrap for PS CI jobs (branding + isolated HOME)."

inputs:
  platform_root:
    description: "Path to PS platform checkout (.ps-platform)"
    required: true
  home_dir:
    description: "Workspace-local HOME directory"
    required: false
    default: ".home"

runs:
  using: "composite"
  steps:
    - name: Prepare HOME directory
      shell: bash
      env:
        PS_PLATFORM_ROOT: ${{ inputs.platform_root }}
        PS_HOME_DIR: ${{ inputs.home_dir }}
      run: |
        set -euo pipefail

        platform_root="${PS_PLATFORM_ROOT:-}"
        home_dir="${PS_HOME_DIR:-.home}"

        bash "${platform_root}/tools/scripts/branding/print-section.sh" \
          "runner.home" "Prepare HOME directory"

        mkdir -p "${GITHUB_WORKSPACE}/${home_dir}"
        printf 'HOME=%s\n' "${GITHUB_WORKSPACE}/${home_dir}" >> "$GITHUB_ENV"
