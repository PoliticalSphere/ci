# ==============================================================================
# Political Sphere - License Compliance Policy
# ------------------------------------------------------------------------------
# Purpose:
#   Define allowed and disallowed OSS licenses (SPDX) for dependency checks.
#
# Notes:
#   - Prefer SPDX license identifiers and SPDX expressions.
#   - Enforce default-deny on unknown/unlicensed dependencies.
#   - Exceptions must be explicit, time-bounded, and linked to a risk decision.
# ==============================================================================

meta:
  version: 1.1.0
  owner: political-sphere
  classification: internal
  last_reviewed: 2025-12-19
  review_interval_days: 180

policy:
  mode: allowlist

  enforcement:
    fail_on_unknown: true
    fail_on_unlicensed: true
    allow_file_reference: false # Disallow "SEE LICENSE IN ..." by default

  # SPDX identifiers we accept (policy decision).
  allowlist:
    - 0BSD
    - Apache-2.0
    - BSD-2-Clause
    - BSD-3-Clause
    - BlueOak-1.0.0
    - CC0-1.0
    - ISC
    - MIT
    - Python-2.0
    - MPL-2.0
    - Zlib
    # Consider removing Unlicense unless you explicitly want it:
    # - Unlicense

  # SPDX identifiers we explicitly reject.
  denylist:
    - AGPL-3.0
    - GPL-2.0
    - GPL-3.0
    - LGPL-2.1
    - LGPL-3.0

  # Expression parsing policy:
  # - If the license is a single SPDX id: allow if in allowlist and not in denylist
  # - If an SPDX expression: every referenced license id must be allowlisted and none denylisted
  # - If "WITH" exceptions appear: treat as unknown unless explicitly allowlisted below
  expressions:
    allow_spdx_expressions: true
    forbid_with_exceptions_by_default: true
    allowlisted_with_exceptions: []
    # Example if you later decide to allow:
    # allowlisted_with_exceptions:
    #   - "Apache-2.0 WITH LLVM-exception"

  # Normalisation rules for non-standard strings emitted by tooling
  normalisation:
    trim: true
    collapse_whitespace: true
    uppercase_operators: true # normalise "or"/"and" to "OR"/"AND"

  # Ignore list should be rare and justified (prefer explicit exceptions).
  ignore_packages: []

  exceptions:
    # Time-bounded, documented exceptions. Keep small.
    packages: []
    # Example:
    # packages:
    #   - id: LIC-EX-001
    #     status: active
    #     package: some-dependency
    #     version_range: ">=1.2.0 <2.0.0"
    #     detected_license: "Apache-2.0 WITH LLVM-exception"
    #     rationale: "Required transitively; no viable alternative. Risk accepted."
    #     risk_decision_id: RD-2025-0XX
    #     review_by: 2026-03-19
